# .tom_metadata/tom_master.yaml
# GENERATED FILE - DO NOT EDIT DIRECTLY
# Regenerate with: tom :generate-master

scan-timestamp: "2026-01-13T17:00:00Z"

# === WORKSPACE CONFIGURATION (from tom_workspace.yaml) ===

name: tom

binaries: bin/

operating-systems: [macos, linux, windows]
mobile-platforms: [android, ios]

# Project type definitions
project-types:
  dart-package:
    name: Dart Package
    description: A publishable Dart library
    metadata-files:
      pubspec-yaml: pubspec.yaml
      build-yaml: build.yaml
  dart-console:
    name: Dart Console App
    description: A Dart command-line application
    metadata-files:
      pubspec-yaml: pubspec.yaml
  flutter-app:
    name: Flutter Application
    description: A Flutter mobile/web application
    metadata-files:
      pubspec-yaml: pubspec.yaml
  vscode-extension:
    name: VS Code Extension
    description: A Visual Studio Code extension
    metadata-files:
      package-json: package.json

# Workspace modes configuration (same structure as tom_workspace.yaml)
workspace-modes:
  mode-types: [environment, execution, cloud-provider, deployment, publishing]
  
  supported:
    - name: development
      description: Development mode
      implies: [relative_build]
    - name: production
      description: Production mode
  
  environment-modes:
    default: local
    local:
      description: Local development
      modes: [development]
    prod:
      description: Production
      modes: [production]
  
  execution-modes:
    default: local
    local:
      description: Run directly
    docker:
      description: Run in container
  
  cloud-provider-modes:
    default: aws
    aws:
      description: Amazon Web Services
    gcp:
      description: Google Cloud Platform
  
  deployment-modes:
    default: none
    none:
      description: No deployment
    docker-compose:
      description: Docker Compose
    kubernetes:
      description: Kubernetes
  
  publishing-modes:
    default: development
    development:
      description: Development builds
    release:
      description: Production releases
  
  action-mode-configuration:
    default:
      environment: local
      execution: local
      cloud-provider: aws
      deployment: none
      publishing: development
    build:
      description: Build for local
      environment: local
      execution: local
    build_prod:
      description: Build for production
      environment: prod
      execution: docker
      publishing: release
    deploy_prod:
      description: Deploy to production
      environment: prod
      execution: cloud
      deployment: kubernetes

# Cross-compilation settings
cross-compilation:
  all-targets: [linux-x64, linux-arm64, darwin-x64, darwin-arm64, win32-x64]
  build-on:
    darwin-arm64:
      targets: [darwin-arm64]
    linux-x64:
      targets: [linux-x64, linux-arm64]

# Action definitions (with pre/post commands)
actions:
  build:
    name: build
    description: Build the project
    default:
      pre-commands:
        - echo "Starting build..."
      commands:
        - dart analyze lib test
        - dart test
      post-commands:
        - echo "Build complete"
    dart-console:
      commands:
        - dart analyze lib bin test
        - dart test
        - dart compile exe bin/main.dart
  deploy:
    name: deploy
    description: Deploy the project
    skip-types: [dart_package]
    default:
      pre-commands:
        - echo "Preparing deployment..."
      commands:
        - docker-compose up -d
      post-commands:
        - echo "Deployment complete"

# Group definitions
groups:
  uam:
    name: uam
    description: UAM application suite
    projects: [tom_uam_client, tom_uam_server, tom_uam_shared]
    project-info-overrides:
      cloud-provider: aws
      deployment: kubernetes

# Mode type definitions (same structure as tom_workspace.yaml)
environment-mode-definitions:
  default:
    description: Default environment
  local:
    description: Local development
    working-dir: .
    variables:
      DEBUG: "true"
  prod:
    description: Production environment
    variables:
      DEBUG: "false"

execution-mode-definitions:
  default:
    working-dir: .
  local:
    description: Run directly on host
  docker:
    description: Run in container
    image: dart:stable
  cloud:
    description: Run on cloud platform
    provider: aws

deployment-mode-definitions:
  default:
    strategy: rolling
  none:
    description: No deployment
  docker-compose:
    description: Docker Compose deployment
    compose-file: docker-compose.yml
  kubernetes:
    description: Kubernetes deployment
    namespace: default

cloud-provider-mode-definitions:
  default:
    region: us-east-1
  aws:
    name: Amazon Web Services
    region: "[[AWS_REGION]]"
    account-id: "[[AWS_ACCOUNT_ID]]"
  gcp:
    name: Google Cloud Platform
    project-id: "[[GCP_PROJECT_ID]]"

publishing-mode-definitions:
  default:
    changelog: CHANGELOG.md
  development:
    description: Development builds
    publish: false
  release:
    description: Production release
    publish: true
    tag-prefix: v

# Pipelines
pipelines:
  ci:
    global-parameters: [--verbose]
    projects:
      - name: tom_build
      - name: tom_tools
    actions:
      - action: analyze
      - action: test
      - action: build

# Project info (same structure as tom_workspace.yaml)
project-info:
  tom_build:
    cross-compilation:
      all-targets: [darwin-x64, darwin-arm64, linux-x64, win32-x64]
  tom_uam_server:
    action-mode-definitions:
      build:
        execution: docker
      deploy:
        deployment: kubernetes
        cloud-provider: aws

# Dependencies
deps:
  sdk: ^3.10.4
  path: ^1.9.0
  yaml: ^3.1.2

deps-dev:
  test: ^1.28.0
  lints: ^6.0.0

# Version settings
version-settings:
  prerelease-tag: dev
  auto-increment: true
  min-dev-build: 1
  action-counter: 42

# Custom tags (integrated at top level, not in a custom-tags block)
my-custom-setting: value
another-setting:
  nested: true

# === COMPUTED FIELDS (generated by Tom) ===

# Build order (calculated from build-after dependencies)
build-order:
  - tom_core_kernel
  - tom_build
  - tom_ai
  - tom_uam_shared
  - tom_uam_client
  - tom_uam_server

# Action order (calculated from action-order dependencies)
action-order:
  build:
    - tom_core_kernel
    - tom_build
    - tom_ai
    - tom_uam_shared
    - tom_uam_client
    - tom_uam_server
  deploy:
    - tom_uam_shared
    - tom_uam_server

# === PROJECTS (with full computed details) ===

projects:
  tom_core_kernel:
    name: tom_core_kernel
    type: dart-package
    description: Core kernel library
    
    # Build ordering
    build-after: []
    action-order: {}
    
    # Features (auto-detected)
    features:
      publishable: true
      has-tests: true
      has-examples: true
      has-build-runner: false
    
    # Mode definitions (final state after processing all levels)
    environment-mode-definitions:
      local:
        description: Local development
        working-dir: .
        variables:
          DEBUG: "true"
      prod:
        description: Production environment
        variables:
          DEBUG: "false"
    
    execution-mode-definitions:
      local:
        description: Run directly on host
      docker:
        description: Run in container
        image: dart:stable
    
    # Actions (merged with workspace defaults)
    actions:
      build:
        name: build
        default:
          pre-commands:
            - echo "Starting build..."
          commands:
            - dart analyze lib test
            - dart test
          post-commands:
            - echo "Build complete"
    
    # Auto-detected source structure
    package-module:
      name: tom_core_kernel
      library-file: lib/tom_core_kernel.dart
      source-folders: [lib/src]
    
    parts:
      core:
        name: core
        library-file: lib/src/core/core.dart
        modules:
          base:
            name: base
            library-file: lib/src/core/base/base.dart
    
    # Discovered files
    tests: [test/]
    examples: [example/]
    docs: [doc/]
    copilot-guidelines: []
    binaries: bin/
    
    # Metadata files (as direct tags, not inside metadata-files block)
    pubspec-yaml:
      name: tom_core_kernel
      version: 1.0.0
      description: Core kernel library
      environment:
        sdk: ^3.10.4
      dependencies:
        path: ^1.9.0
      dev_dependencies:
        test: ^1.28.0
    
    # Executables
    executables: []

  tom_uam_server:
    name: tom_uam_server
    type: dart-console
    description: UAM Server application
    
    # Build ordering
    build-after:
      - tom_uam_shared
      - tom_core_kernel
    action-order:
      deploy-after: [tom_uam_shared]
    
    # Features
    features:
      publishable: false
      has-tests: true
      has-examples: false
      has-docker: true
    
    # Mode definitions (final state - workspace merged with project overrides)
    environment-mode-definitions:
      local:
        description: Local development
        working-dir: .
        variables:
          DEBUG: "true"
      prod:
        description: Production environment
        variables:
          DEBUG: "false"
    
    execution-mode-definitions:
      local:
        description: Run directly on host
      docker:
        description: Docker container for server
        image: tom-uam-server
        dockerfile: Dockerfile
        compose-file: docker-compose.yml
    
    deployment-mode-definitions:
      kubernetes:
        dockerfile: Dockerfile
        target-platforms: [linux/amd64, linux/arm64]
    
    # Cross-compilation (project override)
    cross-compilation:
      all-targets: [linux-x64, linux-arm64]
      build-on:
        linux-x64:
          targets: [linux-x64, linux-arm64]
    
    # Actions (merged with pre/post commands)
    actions:
      build:
        name: build
        default:
          pre-commands:
            - echo "Building server..."
          commands:
            - dart analyze lib bin test
            - dart test
            - dart compile exe bin/server.dart -o bin/server
          post-commands:
            - echo "Server build complete"
      deploy:
        name: deploy
        default:
          pre-commands:
            - echo "Preparing server deployment..."
          commands:
            - docker-compose up -d
          post-commands:
            - echo "Server deployed"
    
    # Source structure
    package-module:
      name: tom_uam_server
      library-file: lib/tom_uam_server.dart
      source-folders: [lib/src]
    
    parts: {}
    
    # Discovered files
    tests: [test/]
    examples: []
    docs: []
    copilot-guidelines: []
    binaries: bin/
    
    # Executables
    executables:
      - source: bin/server.dart
        output: server
    
    # Metadata files (as direct tags)
    pubspec-yaml:
      name: tom_uam_server
      version: 1.0.0
      description: UAM Server application
    
    # Custom tags (integrated at project level)
    server-config:
      port: 8080
      max-connections: 100
